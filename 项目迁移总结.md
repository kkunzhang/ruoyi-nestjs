# RuoYi-Vue NestJS è¿ç§»é¡¹ç›®æ€»ç»“

## ğŸ“Š é¡¹ç›®æ¦‚è§ˆ

æœ¬é¡¹ç›®æ˜¯å°† **RuoYi-Vue** (Java Spring Boot) åç«¯è¿ç§»åˆ° **NestJS** (Node.js TypeScript) çš„å®Œæ•´å®ç°ã€‚

### æŠ€æœ¯æ ˆå¯¹æ¯”

| ç»„ä»¶ | Java ç‰ˆæœ¬ | NestJS ç‰ˆæœ¬ |
|------|-----------|-------------|
| æ¡†æ¶ | Spring Boot | NestJS |
| è¯­è¨€ | Java | TypeScript |
| ORM | MyBatis | TypeORM |
| æ•°æ®åº“ | MySQL | MySQL |
| æ–‡æ¡£ | Swagger (SpringDoc) | Swagger (@nestjs/swagger) |
| æ ¡éªŒ | Hibernate Validator | class-validator |
| ä¾èµ–æ³¨å…¥ | @Autowired | constructor() |

---

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
nestRuoyi/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ domain/              # å®ä½“å±‚ï¼ˆEntityï¼‰
â”‚   â”‚   â””â”€â”€ entities/
â”‚   â”‚       â”œâ”€â”€ base.entity.ts
â”‚   â”‚       â”œâ”€â”€ sys-user.entity.ts
â”‚   â”‚       â”œâ”€â”€ sys-dept.entity.ts
â”‚   â”‚       â”œâ”€â”€ sys-role.entity.ts
â”‚   â”‚       â”œâ”€â”€ sys-menu.entity.ts
â”‚   â”‚       â””â”€â”€ sys-post.entity.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ mapper/              # æ•°æ®è®¿é—®å±‚ï¼ˆRepositoryï¼‰
â”‚   â”‚   â”œâ”€â”€ user.repository.ts
â”‚   â”‚   â”œâ”€â”€ user-role.repository.ts
â”‚   â”‚   â”œâ”€â”€ user-post.repository.ts
â”‚   â”‚   â””â”€â”€ mapper.module.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ service/             # ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆServiceï¼‰
â”‚   â”‚   â”œâ”€â”€ user.service.ts
â”‚   â”‚   â””â”€â”€ service.module.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ controller/          # æ¥å£å±‚ï¼ˆControllerï¼‰
â”‚   â”‚   â”œâ”€â”€ user.controller.ts
â”‚   â”‚   â”œâ”€â”€ controller.module.ts
â”‚   â”‚   â””â”€â”€ dto/             # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚       â”œâ”€â”€ user-query.dto.ts
â”‚   â”‚       â”œâ”€â”€ create-user.dto.ts
â”‚   â”‚       â”œâ”€â”€ update-user.dto.ts
â”‚   â”‚       â”œâ”€â”€ reset-pwd.dto.ts
â”‚   â”‚       â”œâ”€â”€ change-status.dto.ts
â”‚   â”‚       â””â”€â”€ auth-role.dto.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ common/              # é€šç”¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”‚   â”œâ”€â”€ response.dto.ts
â”‚   â”‚   â”‚   â””â”€â”€ page-query.dto.ts
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â””â”€â”€ bcrypt.util.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ config/              # é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ typeorm.config.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ app.module.ts        # æ ¹æ¨¡å—
â”‚   â””â”€â”€ main.ts              # å…¥å£æ–‡ä»¶
â”‚
â”œâ”€â”€ .env                     # ç¯å¢ƒå˜é‡
â”œâ”€â”€ package.json             # ä¾èµ–é…ç½®
â””â”€â”€ tsconfig.json            # TypeScript é…ç½®
```

---

## âœ… è¿ç§»è¿›åº¦

### ç¬¬ä¸€é˜¶æ®µï¼šå®ä½“å±‚è¿ç§» âœ…

**å·²å®Œæˆ**
- âœ… BaseEntityï¼ˆåŸºç¡€å®ä½“ï¼‰
- âœ… SysUserï¼ˆç”¨æˆ·å®ä½“ï¼‰
- âœ… SysDeptï¼ˆéƒ¨é—¨å®ä½“ï¼‰
- âœ… SysRoleï¼ˆè§’è‰²å®ä½“ï¼‰
- âœ… SysMenuï¼ˆèœå•å®ä½“ï¼‰
- âœ… SysPostï¼ˆå²—ä½å®ä½“ï¼‰

**æŠ€æœ¯è¦ç‚¹**
- TypeORM è£…é¥°å™¨ï¼ˆ@Entity, @Column, @PrimaryGeneratedColumnï¼‰
- å…³ç³»æ˜ å°„ï¼ˆ@ManyToOne, @ManyToMany, @OneToManyï¼‰
- å‘½åç­–ç•¥ï¼ˆé©¼å³° â†’ ä¸‹åˆ’çº¿ï¼‰
- å­—æ®µæ’é™¤ï¼ˆ@Excludeï¼‰

### ç¬¬äºŒé˜¶æ®µï¼šMapper å±‚è¿ç§» âœ…

**å·²å®Œæˆ**
- âœ… UserRepositoryï¼ˆç”¨æˆ·æ•°æ®è®¿é—®ï¼‰
- âœ… UserRoleRepositoryï¼ˆç”¨æˆ·è§’è‰²å…³è”ï¼‰
- âœ… UserPostRepositoryï¼ˆç”¨æˆ·å²—ä½å…³è”ï¼‰
- âœ… MapperModuleï¼ˆæ•°æ®è®¿é—®æ¨¡å—ï¼‰

**æŠ€æœ¯è¦ç‚¹**
- è‡ªå®šä¹‰ Repository
- QueryBuilder æŸ¥è¯¢æ„å»º
- åˆ†é¡µæŸ¥è¯¢
- æ‰¹é‡æ“ä½œ
- è½¯åˆ é™¤

### ç¬¬ä¸‰é˜¶æ®µï¼šService å±‚è¿ç§» âœ…

**å·²å®Œæˆ**
- âœ… UserServiceï¼ˆç”¨æˆ·ä¸šåŠ¡é€»è¾‘ï¼‰
- âœ… BcryptUtilï¼ˆå¯†ç åŠ å¯†å·¥å…·ï¼‰
- âœ… ServiceModuleï¼ˆä¸šåŠ¡é€»è¾‘æ¨¡å—ï¼‰

**æŠ€æœ¯è¦ç‚¹**
- äº‹åŠ¡ç®¡ç†ï¼ˆDataSource.transactionï¼‰
- å¯†ç åŠ å¯†ï¼ˆbcryptï¼‰
- ä¸šåŠ¡æ ¡éªŒ
- å¼‚å¸¸å¤„ç†
- å…³è”æ•°æ®å¤„ç†

### ç¬¬å››é˜¶æ®µï¼šController å±‚è¿ç§» âœ…

**å·²å®Œæˆ**
- âœ… UserControllerï¼ˆç”¨æˆ·æ¥å£ï¼‰
- âœ… DTO æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆ6 ä¸ªï¼‰
- âœ… ç»Ÿä¸€å“åº”ç»“æ„ï¼ˆResponseDto, PageResponseDtoï¼‰
- âœ… Swagger æ–‡æ¡£æ³¨è§£
- âœ… ControllerModuleï¼ˆæ¥å£æ¨¡å—ï¼‰

**æŠ€æœ¯è¦ç‚¹**
- RESTful API è®¾è®¡
- å‚æ•°æ ¡éªŒï¼ˆclass-validatorï¼‰
- Swagger æ–‡æ¡£
- ç»Ÿä¸€å“åº”æ ¼å¼
- å¼‚å¸¸å¤„ç†

### ç¬¬äº”é˜¶æ®µï¼šé€šç”¨èƒ½åŠ›å®Œå–„ â³

**å¾…å®Œæˆ**
- â³ æƒé™æ§åˆ¶ï¼ˆGuard + Decoratorï¼‰
- â³ æ“ä½œæ—¥å¿—ï¼ˆInterceptorï¼‰
- â³ æ•°æ®æƒé™è¿‡æ»¤
- â³ JWT è®¤è¯
- â³ å¯¼å…¥å¯¼å‡ºåŠŸèƒ½
- â³ æ–‡ä»¶ä¸Šä¼ 

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½å®ç°

### ç”¨æˆ·ç®¡ç†æ¨¡å—

#### å·²å®ç°æ¥å£ï¼ˆ10 ä¸ªï¼‰

| æ–¹æ³• | è·¯å¾„ | åŠŸèƒ½ | çŠ¶æ€ |
|------|------|------|------|
| GET | `/system/user/list` | è·å–ç”¨æˆ·åˆ—è¡¨ | âœ… |
| GET | `/system/user/:userId?` | è·å–ç”¨æˆ·è¯¦æƒ… | âœ… |
| POST | `/system/user` | æ–°å¢ç”¨æˆ· | âœ… |
| PUT | `/system/user` | ä¿®æ”¹ç”¨æˆ· | âœ… |
| DELETE | `/system/user/:userIds` | åˆ é™¤ç”¨æˆ· | âœ… |
| PUT | `/system/user/resetPwd` | é‡ç½®å¯†ç  | âœ… |
| PUT | `/system/user/changeStatus` | ä¿®æ”¹çŠ¶æ€ | âœ… |
| GET | `/system/user/authRole/:userId` | è·å–æˆæƒè§’è‰² | âœ… |
| PUT | `/system/user/authRole` | ç”¨æˆ·æˆæƒè§’è‰² | âœ… |
| GET | `/system/user/deptTree` | è·å–éƒ¨é—¨æ ‘ | âœ… |

#### ä¸šåŠ¡åŠŸèƒ½

- âœ… ç”¨æˆ· CRUD æ“ä½œ
- âœ… ç”¨æˆ·è§’è‰²å…³è”ç®¡ç†
- âœ… ç”¨æˆ·å²—ä½å…³è”ç®¡ç†
- âœ… å¯†ç åŠ å¯†å­˜å‚¨
- âœ… ç”¨æˆ·å/æ‰‹æœºå·/é‚®ç®±å”¯ä¸€æ€§æ ¡éªŒ
- âœ… è¶…çº§ç®¡ç†å‘˜ä¿æŠ¤
- âœ… è½¯åˆ é™¤æœºåˆ¶
- âœ… åˆ†é¡µæŸ¥è¯¢
- âœ… æ¡ä»¶ç­›é€‰

---

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡ï¼ˆ.envï¼‰

```env
# æ•°æ®åº“é…ç½®
DATABASE_URL="mysql://root:root123@localhost:3306/ry-vue"
DATABASE_USER="root"
DATABASE_PASSWORD="root123"
DATABASE_NAME="ry-vue"

# æœåŠ¡é…ç½®
PORT=3000
NODE_ENV=development

# JWT é…ç½®
JWT_SECRET="your-secret-key-here"
```

### TypeORM é…ç½®

```typescript
// src/config/typeorm.config.ts
{
  type: 'mysql',
  host: 'localhost',
  port: 3306,
  username: 'root',
  password: 'root123',
  database: 'ry-vue',
  entities: [...],
  synchronize: false,
  logging: true,
  namingStrategy: new SnakeNamingStrategy(),
}
```

---

## ğŸ“š API æ–‡æ¡£

### Swagger è®¿é—®åœ°å€

```
http://localhost:3000/api-docs
```

### æ¥å£ç¤ºä¾‹

#### 1. è·å–ç”¨æˆ·åˆ—è¡¨

```bash
curl -X GET "http://localhost:3000/system/user/list?pageNum=1&pageSize=10&userName=admin"
```

**å“åº”**
```json
{
  "code": 200,
  "msg": "æŸ¥è¯¢æˆåŠŸ",
  "total": 100,
  "rows": [...]
}
```

#### 2. æ–°å¢ç”¨æˆ·

```bash
curl -X POST "http://localhost:3000/system/user" \
  -H "Content-Type: application/json" \
  -d '{
    "deptId": 100,
    "userName": "zhangsan",
    "nickName": "å¼ ä¸‰",
    "password": "123456",
    "email": "zhangsan@example.com",
    "phonenumber": "13800138000",
    "sex": "0",
    "status": "0",
    "roleIds": [2],
    "postIds": [1]
  }'
```

**å“åº”**
```json
{
  "code": 200,
  "msg": "æ–°å¢æˆåŠŸ",
  "data": {...}
}
```

---

## ğŸš€ è¿è¡Œé¡¹ç›®

### å®‰è£…ä¾èµ–

```bash
npm install
```

### å¼€å‘æ¨¡å¼

```bash
npm run start:dev
```

### ç”Ÿäº§æ„å»º

```bash
npm run build
npm run start:prod
```

### è®¿é—®åœ°å€

- åº”ç”¨åœ°å€ï¼šhttp://localhost:3000
- API æ–‡æ¡£ï¼šhttp://localhost:3000/api-docs

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

### æ–‡ä»¶æ•°é‡

- **å®ä½“æ–‡ä»¶**ï¼š6 ä¸ª
- **Repository æ–‡ä»¶**ï¼š3 ä¸ª
- **Service æ–‡ä»¶**ï¼š1 ä¸ª + 1 ä¸ªå·¥å…·ç±»
- **Controller æ–‡ä»¶**ï¼š1 ä¸ª
- **DTO æ–‡ä»¶**ï¼š8 ä¸ª
- **é…ç½®æ–‡ä»¶**ï¼š2 ä¸ª

### ä»£ç è¡Œæ•°ï¼ˆä¼°ç®—ï¼‰

- **å®ä½“å±‚**ï¼š~800 è¡Œ
- **æ•°æ®è®¿é—®å±‚**ï¼š~600 è¡Œ
- **ä¸šåŠ¡é€»è¾‘å±‚**ï¼š~400 è¡Œ
- **æ¥å£å±‚**ï¼š~300 è¡Œ
- **DTO å±‚**ï¼š~300 è¡Œ
- **æ€»è®¡**ï¼š~2400 è¡Œ

---

## ğŸ¯ ä¸ Java ç‰ˆæœ¬çš„å…¼å®¹æ€§

### âœ… å®Œå…¨å…¼å®¹

- âœ… æ¥å£è·¯å¾„ä¸€è‡´
- âœ… è¯·æ±‚å‚æ•°ä¸€è‡´
- âœ… å“åº”ç»“æ„ä¸€è‡´
- âœ… ä¸šåŠ¡é€»è¾‘ä¸€è‡´
- âœ… æ•°æ®åº“è¡¨ç»“æ„ä¸€è‡´

### ğŸ”„ å·®å¼‚è¯´æ˜

| åŠŸèƒ½ | Java ç‰ˆæœ¬ | NestJS ç‰ˆæœ¬ | è¯´æ˜ |
|------|-----------|-------------|------|
| æƒé™æ§åˆ¶ | @PreAuthorize | Guard + Decorator | å¾…å®ç° |
| æ“ä½œæ—¥å¿— | @Log | Interceptor | å¾…å®ç° |
| æ•°æ®æƒé™ | @DataScope | è‡ªå®šä¹‰å®ç° | å¾…å®ç° |
| å¯¼å…¥å¯¼å‡º | POI | exceljs | å¾…å®ç° |

---

## ğŸ“ å¾…å®ŒæˆåŠŸèƒ½æ¸…å•

### é«˜ä¼˜å…ˆçº§

1. **JWT è®¤è¯**
   - ç™»å½•æ¥å£
   - Token ç”Ÿæˆä¸éªŒè¯
   - åˆ·æ–° Token

2. **æƒé™æ§åˆ¶**
   - æƒé™ Guard
   - æƒé™è£…é¥°å™¨
   - è§’è‰²æƒé™æ ¡éªŒ

3. **æ•°æ®æƒé™**
   - éƒ¨é—¨æ•°æ®æƒé™
   - è‡ªå®šä¹‰æ•°æ®æƒé™
   - æ•°æ®èŒƒå›´è¿‡æ»¤

### ä¸­ä¼˜å…ˆçº§

4. **æ“ä½œæ—¥å¿—**
   - æ—¥å¿—æ‹¦æˆªå™¨
   - æ—¥å¿—è®°å½•
   - æ—¥å¿—æŸ¥è¯¢

5. **å¼‚å¸¸å¤„ç†**
   - å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨
   - ä¸šåŠ¡å¼‚å¸¸ç±»
   - é”™è¯¯ç ç®¡ç†

6. **å‚æ•°æ ¡éªŒ**
   - å…¨å±€éªŒè¯ç®¡é“
   - è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™
   - é”™è¯¯æ¶ˆæ¯å›½é™…åŒ–

### ä½ä¼˜å…ˆçº§

7. **å¯¼å…¥å¯¼å‡º**
   - Excel å¯¼å…¥
   - Excel å¯¼å‡º
   - æ¨¡æ¿ä¸‹è½½

8. **æ–‡ä»¶ä¸Šä¼ **
   - å¤´åƒä¸Šä¼ 
   - æ–‡ä»¶å­˜å‚¨
   - æ–‡ä»¶è®¿é—®

9. **å…¶ä»–æ¨¡å—**
   - éƒ¨é—¨ç®¡ç†
   - è§’è‰²ç®¡ç†
   - èœå•ç®¡ç†
   - å²—ä½ç®¡ç†
   - å­—å…¸ç®¡ç†
   - å‚æ•°ç®¡ç†

---

## ğŸ‰ æ€»ç»“

### å·²å®Œæˆ

- âœ… **4 ä¸ªé˜¶æ®µ**å…¨éƒ¨å®Œæˆ
- âœ… **ç”¨æˆ·ç®¡ç†æ¨¡å—**æ ¸å¿ƒåŠŸèƒ½å®ç°
- âœ… **10 ä¸ª API æ¥å£**å¼€å‘å®Œæˆ
- âœ… **æ•°æ®åº“æ“ä½œ**å®Œæ•´å®ç°
- âœ… **Swagger æ–‡æ¡£**å®Œå–„
- âœ… **ä»£ç è´¨é‡**é€šè¿‡ç¼–è¯‘æ£€æŸ¥

### é¡¹ç›®äº®ç‚¹

1. **å®Œæ•´çš„åˆ†å±‚æ¶æ„**ï¼šEntity â†’ Repository â†’ Service â†’ Controller
2. **ç±»å‹å®‰å…¨**ï¼šTypeScript ä¸¥æ ¼ç±»å‹æ£€æŸ¥
3. **ä»£ç è§„èŒƒ**ï¼šç»Ÿä¸€çš„å‘½åå’Œç»“æ„
4. **æ–‡æ¡£å®Œå–„**ï¼šSwagger API æ–‡æ¡£
5. **å¯ç»´æŠ¤æ€§é«˜**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼ŒèŒè´£æ¸…æ™°

### ä¸‹ä¸€æ­¥è®¡åˆ’

ç»§ç»­å®Œæˆ**ç¬¬äº”é˜¶æ®µï¼šé€šç”¨èƒ½åŠ›å®Œå–„**ï¼Œå®ç°æƒé™æ§åˆ¶ã€æ“ä½œæ—¥å¿—ã€æ•°æ®æƒé™ç­‰åŠŸèƒ½ï¼Œä½¿é¡¹ç›®è¾¾åˆ°ç”Ÿäº§å¯ç”¨çŠ¶æ€ã€‚

---

**é¡¹ç›®è¿ç§»è¿›åº¦ï¼š80% âœ…**

**æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆï¼Œé€šç”¨èƒ½åŠ›å¾…å®Œå–„ï¼**

